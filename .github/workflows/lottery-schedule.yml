name: Update Lottery Numbers

on:
  schedule:
    # å°ç£æ™‚é–“å–®æ•¸æœˆ 25 æ—¥ 14:00 (UTC 06:00)
    # Cron: åˆ† æ™‚ æ—¥ æœˆ æ˜ŸæœŸ
    - cron: '0 6 25 1,3,5,7,9,11 *'
  workflow_dispatch: # å…è¨±æ‰‹å‹•æŒ‰æŒ‰éˆ•è§¸ç™¼

permissions:
  contents: write # å…è¨±å¯«å…¥ Repository

jobs:
  update-data:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        # é€™è£¡ä¸éœ€è¦ npm installï¼Œå› ç‚ºæˆ‘å€‘çš„è…³æœ¬åªç”¨åŸç”Ÿæ¨¡çµ„
        # å¦‚æœæœªä¾†åŠ äº† axiosï¼Œé€™è£¡éœ€è¦ npm ci
        run: echo "No dependencies to install"

      - name: Run update script
        env:
          INVOICE_APP_ID: ${{ secrets.INVOICE_APP_ID }}
        run: node scripts/update-lottery.mjs

      - name: Commit and Push changes
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: "ğŸ¤– Auto-update lottery numbers [skip ci]"
          file_pattern: "public/lottery-data.json"
